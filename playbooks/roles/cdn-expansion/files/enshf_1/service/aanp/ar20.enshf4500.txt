configure terminal
!
interface Loopback101
 description Source interface for EBGP session with Akamai
 ip address False False
 no ip redirects
!
interface Port-channel40
 description [ext,iv-g=aanp,iv-s=cdn_aanp] Port-Channel to Cisco 4900M Akamai Managed Switch
 mtu 8226
 ip address 94.15.95.129/25 255.255.255.128
 no ip redirects
!
interface TenGigabitEthernet1/31
 description [no-mon,ext,iv-g=aanp,iv-s=cdn_aanp] Link 1 - PCH40 to aanp NIC_1 Server
 no switchport
 mtu 8226
 no ip address
 no ip redirects
 no cdp enable
 channel-protocol lacp
 channel-group 40 mode active
!
interface TenGigabitEthernet1/32
 description [no-mon,ext,iv-g=aanp,iv-s=cdn_aanp] Link 2 - PCH40 to aanp NIC_2 Server
 no switchport
 mtu 8226
 no ip address
 no ip redirects
 no cdp enable
 channel-protocol lacp
 channel-group 40 mode active
!
!
router bgp 65444
 template peer-policy CDN-AANP-EBGP
  route-map RM-DENY-ALL in
  route-map RM-EXPORT-DNS out
  next-hop-self
  send-community
 exit-peer-policy
 !
 template peer-session OFFNET-CDN-AANP-PEER
  remote-as 21357
  local-as 5607
  ebgp-multihop 255
  update-source Loopback101
 exit-peer-session
 !
 neighbor 195.245.126.50 inherit peer-session OFFNET-CDN-AANP-PEER
 neighbor 195.245.126.50 description CDN-AKAMAI-OFFNET-PEER
 neighbor 195.245.126.50 password None
 !
 address-family ipv4
  neighbor 195.245.126.50 activate
  neighbor 195.245.126.50 inherit peer-policy CDN-AANP-EBGP
 exit-address-family
!
ip prefix-list PL-ENSHF-DNS seq 5 permit 90.207.224.58/32
ip prefix-list PL-ENSHF-DNS seq 10 permit 90.207.224.59/32
ip prefix-list PL-ENSHF-DNS seq 15 permit 90.207.224.49/32
ip prefix-list PL-ENSHF-DNS seq 20 permit 90.207.224.50/32
ip prefix-list PL-ENSHF-DNS seq 25 permit 90.207.224.60/32
ip prefix-list PL-ENSHF-DNS seq 30 permit 90.207.224.61/32
ip prefix-list PL-ENSHF-DNS seq 35 permit 90.207.224.62/32
ip prefix-list PL-ENSHF-DNS seq 40 permit 90.207.224.63/32
!
!
ip prefix-list PL-SKY-IP-RANGE seq 5 permit 46.64.0.0/15
ip prefix-list PL-SKY-IP-RANGE seq 10 permit 78.86.0.0/16
ip prefix-list PL-SKY-IP-RANGE seq 15 permit 78.105.0.0/16
ip prefix-list PL-SKY-IP-RANGE seq 20 permit 93.96.0.0/16
ip prefix-list PL-SKY-IP-RANGE seq 25 permit 94.192.0.0/14
ip prefix-list PL-SKY-IP-RANGE seq 30 permit 149.241.0.0/16
ip prefix-list PL-SKY-IP-RANGE seq 35 permit 188.220.0.0/14
ip prefix-list PL-SKY-IP-RANGE seq 40 permit 2.120.0.0/13
ip prefix-list PL-SKY-IP-RANGE seq 45 permit 2.216.0.0/13
ip prefix-list PL-SKY-IP-RANGE seq 50 permit 5.64.0.0/13
ip prefix-list PL-SKY-IP-RANGE seq 55 permit 80.238.0.0/19
ip prefix-list PL-SKY-IP-RANGE seq 60 permit 80.238.32.0/19
ip prefix-list PL-SKY-IP-RANGE seq 65 permit 84.38.32.0/20
ip prefix-list PL-SKY-IP-RANGE seq 70 permit 85.188.192.0/18
ip prefix-list PL-SKY-IP-RANGE seq 75 permit 87.80.0.0/15
ip prefix-list PL-SKY-IP-RANGE seq 85 permit 90.192.0.0/11
ip prefix-list PL-SKY-IP-RANGE seq 90 permit 91.103.32.0/21
ip prefix-list PL-SKY-IP-RANGE seq 95 permit 94.0.0.0/12
ip prefix-list PL-SKY-IP-RANGE seq 100 permit 94.116.0.0/14
ip prefix-list PL-SKY-IP-RANGE seq 105 permit 151.224.0.0/13
ip prefix-list PL-SKY-IP-RANGE seq 110 permit 176.24.0.0/14
ip prefix-list PL-SKY-IP-RANGE seq 115 permit 176.248.0.0/13
ip prefix-list PL-SKY-IP-RANGE seq 125 permit 194.42.124.0/23
!
route-map RM-EXPORT-DNS permit 10
 description Match DNS Prefixes Allocated to POP & Set Primary Akamai Community
 match ip address prefix-list PL-ENSHF-DNS
 set community 4589:14424
!
route-map RM-EXPORT-DNS permit 20
 description Match Sky IP Range & Set Secondary Akamai Community
 match ip address prefix-list PL-SKY-IP-RANGE
 set community 4589:14425
!
route-map RM-DENY-ALL deny 10
 description Deny All routes via EBGP
!
end
